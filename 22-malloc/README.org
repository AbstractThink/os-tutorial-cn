[[file:./README_en.md][English]]

/事先需要 Google 的概念：malloc/

*目标：实现一个内存分配器*

我们需要在 =libc/mem.c= 中增加一个内核内存配置器，实现起来很简单，只需要将指针指向
一块空闲的内存即可，而且可以扩充。

使用 =kmalloc= 要求按页对齐，它会返回一个真实的物理地址，接着就可以使用了。

我们将修改 =kernel.c= 文件，让所有的 “shell” 代码放在这里。我们只需要使用新的
=kmalloc= 函数，并检查我们的第一页是否开始于 0x10000 (在 
=mem.c= 文件中硬编码的). 接着使用
=kmalloc= 产生一个新页，它应试是 4096 字节对齐的，或者是这之前的
=0x10000= 。

注意，我们还增加了一个 =string.c:hex_to_ascii= 函数用于更好地打印十六进制数字。

还有一个美化修改是将 =types.c= 重命名为
 =type.c= , 主要是为了语言一致性。

其它文件在本次课没有修改。